<h1>Select Map</h1>
<div class="center-layout">
  <div class="buttonbar">
    <button class="btn btn-outline-secondary btn-tool" (click)="newFolder()" placement="bottom" ngbTooltip="New Folder for Maps">
      <fa-icon icon="folder" size="lg"></fa-icon>
    </button>
    <button class="btn btn-outline-secondary btn-tool" (click)="newMap()" placement="bottom" ngbTooltip="new Map">
      <fa-icon icon="plus" size="lg"></fa-icon>
    </button>
  </div>
</div>
<div class="filter-div">
  <input type="text" class="form-control form-control-sm filter" placeholder="filter" [ngModel]="filter" (ngModelChange)="filterUpdate($event)">
  <div class="clear-filter-icon" (click)="clearFilter()" *ngIf='filter.length>0'>
    <fa-icon icon="times" size="lg"></fa-icon>
  </div>
</div>
<div class="white scroller scroller-dark mt-2 map-scroll" *ngIf="filtered">
  <ng-container *ngIf="recent && recent.length > 0 && filter==''">
    <h2 class="pointer noselect" (click)="isCollapsed['recent'] = !isCollapsed['recent']">
      <fa-icon [fixedWidth]="true" size="lg" [icon]="isCollapsed['recent'] ? 'caret-right' : 'caret-down'"></fa-icon> Recent
    </h2>
    <div [ngbCollapse]="isCollapsed['recent']" class="recent-div">
      <div *ngFor="let m of recent" class="recent">
        <figure (click)="select(m)" placement="bottom" [ngbTooltip]="m.name">
          <img [src]='m.thumb' height="52">
          <div class="overlay">
            <fa-icon class="icon" icon="check"></fa-icon>
          </div>
        </figure>
      </div>
    </div>
  </ng-container>

  <div *ngFor="let mt of filtered ">
    <h2 class="pointer noselect" (click)="isCollapsed[mt.id] = !isCollapsed[mt.id]">
      <fa-icon [fixedWidth]="true" size="lg" [icon]="isCollapsed[mt.id] ? 'caret-right' : 'caret-down'"></fa-icon> {{mt.name}}
    </h2>
    <div [ngbCollapse]="isCollapsed[mt.id]">
      <figure (click)="select(m)" class="figure-choice" *ngFor="let m of mt.maps">
        <img [src]='m.thumb'>
        <figcaption>{{m.name}}</figcaption>
        <div class="overlay">
          <fa-icon class="icon" icon="check" size="2x"></fa-icon>
        </div>
      </figure>
    </div>
  </div>
  <div *ngIf="filtered.length == 0">
    No maps are available. Perhaps you should
    <a class="tab-link" href="#" (click)="newMap()">create one!</a>
  </div>
</div>