<div class="white">
  <h1>Annotations</h1>

  <div class="buttonbar" *ngIf="edit==false">
    <button class="btn btn-outline-secondary btn-tool" (click)="newMarker()" placement="bottom" ngbTooltip="Create a new marker">
      <fa-icon icon="map-marker-alt" size="lg"></fa-icon>
    </button>
    <button class="btn btn-outline-secondary btn-tool" (click)="newPolyline()" placement="bottom" ngbTooltip="Create a new line">
      <img src="./assets/icons/polyline.png">
    </button>
    <button class="btn btn-outline-secondary btn-tool" (click)="newRectangle()" placement="bottom" ngbTooltip="Create a new rectangle">
      <img src="./assets/icons/rectangle.png">
    </button>
    <button class="btn btn-outline-secondary btn-tool" (click)="newCircle()" placement="bottom" ngbTooltip="Create a new circle">
      <img src="./assets/icons/circle.png">
    </button>
    <button class="btn btn-outline-secondary btn-tool" (click)="newPolygon()" placement="bottom" ngbTooltip="Create a new polygon">
      <img src="./assets/icons/polygon.png">
    </button>
  </div>
  <div class="buttonbar" *ngIf="edit==false && !selection.isEmpty()">
    <button *ngIf="!selection.isEmpty()" class="btn btn-outline-secondary btn-tool" (click)="editstart()" placement="bottom"
      ngbTooltip="Edit the selected marker(s)">
      <fa-icon icon="pencil-alt" size="lg"></fa-icon>
    </button>
    <button *ngIf="!selection.isEmpty()" class="btn btn-outline-secondary btn-tool" (click)="permissions()" placement="bottom"
      ngbTooltip="Set the access permissions">
      <fa-icon *ngIf="restricted == true" icon="lock" size="lg" class="lockbtn"></fa-icon>
      <fa-icon *ngIf="restricted == false" icon="unlock" size="lg"></fa-icon>
    </button>
    <button *ngIf="!selection.isEmpty()" class="btn btn-outline-secondary btn-tool" (click)="delete()" placement="bottom" ngbTooltip="Delete the selected marker(s)">
      <fa-icon icon="trash-alt" size="lg"></fa-icon>
    </button>
    <button *ngIf="!selection.isEmpty()" class="btn btn-outline-secondary btn-tool" (click)="deselect()" placement="bottom" ngbTooltip="Deselect Items">
      <fa-icon icon="times" size="lg"></fa-icon>
    </button>
  </div>

  <div class="buttonbar" *ngIf="edit==true">
    <button type="button" class="btn btn-outline-secondary btn-tool px-3" aria-label="Close" (click)="save()">
      <fa-icon icon="save" size="lg"></fa-icon> Save
    </button>
    <button type="button" class="btn btn-outline-secondary btn-tool" aria-label="Close" (click)="cancel()">
      <fa-icon icon="times" size="lg"></fa-icon> Cancel
    </button>
  </div>

  <div class="scroller scroller-dark marker-scroll">
    <!-- Display and Item -->
    <ng-container *ngIf="!edit && selection.items.length>=1">
      <div class="marker-container" *ngFor="let item of selection.items">
        <img *ngIf="itemType(item)=='marker'" [src]="item?._iconUrl" height="40" class="centered mt-2 iconselected">

        <div *ngIf="itemType(item)=='shape'" class="mt-2">
          <app-svgbox [shape]="item" [maxheight]="100" [padding]="10"></app-svgbox>
        </div>

        <h3>{{item?.name}}</h3>
        <span *ngIf="item.group" class="type">{{name(item)}}</span>
        <a href="#" class="coords" (click)="pan()">{{coords(item)}}</a>
        <a *ngIf="item.pageUrl" [href]="item.pageurl" target="_blank">
          <fa-icon icon="globe"></fa-icon> Open Web Link</a>
        <a *ngIf="item.mapLink" href="#" (click)="openLinkedMap()">
          <fa-icon icon="map"></fa-icon> Open Linked Map</a>
        <app-readmore class="text-muted mb-2 description" *ngIf="item.description" [value]="item.description"></app-readmore>
      </div>
    </ng-container>

    <!-- Edit of a single marker -->
    <div *ngIf="edit && itemType(item)=='marker' && selection.items.length==1">
      <app-edit-marker [marker]="item" [map]="map"></app-edit-marker>
    </div>

    <!-- Edit a single shape -->
    <div *ngIf="edit && itemType(item) == 'shape' && selection.items.length == 1">
      <app-edit-shape #editshape [shape]='item'></app-edit-shape>
    </div>

    <!-- Edit of multiple markers -->
    <div *ngIf="edit && types()=='marker' && selection.items.length > 1">
      <div class="form-group">
        <label for="type" class="small">Type</label>
        <app-marker-combo [(ngModel)]="markers.type" [map]="map" (change)="updateMuliEdit()"></app-marker-combo>
      </div>
      <div class="form-group">
        <label for="type" class="small">Group</label>
        <app-marker-group-combo [(ngModel)]="markers.group" [annotation]="markers" (change)="updateMuliEdit()"></app-marker-group-combo>
      </div>
    </div>

    <div *ngIf="edit && types()!='marker' && selection.items.length > 1">
      <div class="form-group">
        <label for="type" class="small">Group</label>
        <app-marker-group-combo [(ngModel)]="markers.group" [annotation]="markers" (change)="updateMuliEdit()"></app-marker-group-combo>
      </div>
    </div>
  </div>
</div>